<style>
 .full-body {
  height: 100dvh;
 }

 .grid-container {
  display: none;
 }

 #ucl {
  display: none !important;
 }
</style>

<!--DOCTYPE html-->
<html lang="en">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>Onam Slideshow</title>
 <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
 <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
 <style>
  * {
   box-sizing: border-box;
  }

  body {
   margin: 0;
   padding: 0;
   font-family: Arial;
   font-size: 17px;
   height: 100dvh;
   display: flex;
   justify-content: center;
   align-items: center;
   text-align: center;
  }

  .floating-btn {
   position: fixed;
   width: 45px;
   height: 45px;
   display: flex;
   align-items: center;
   font-size: 1.3rem;
   justify-content: center;
   opacity: 0.9;
  }

  .home {
   bottom: 140px;
   right: 20px;
  }

  .file {
   bottom: 80px;
   right: 20px;
  }

  #bgVideo {
   position: fixed;
   right: 0;
   bottom: 0;
   min-width: 100%;
   min-height: 100%;
   z-index: -1;
   /* send video to back */
  }

  .content {
   color: #f1f1f1;
   margin-top: 450px;
   width: 100%;
   max-width: 700px;
  }

  #myBtn {
   width: 200px;
   font-size: 18px;
   padding: 10px;
   border: none;
   background: #000;
   color: #fff;
   cursor: pointer;
  }

  #myBtn:hover {
   background: #ddd;
   color: black;
  }

  #loader {
   transition: opacity 0.5s ease;
   z-index: 2000;
  }

  #loader.hidden {
   opacity: 0;
   pointer-events: none;
  }

  #progressBar {
   transition: width .5s ease-in-out;
  }

  .carousel,
  .carousel-item,
  .carousel-inner {
   height: 80dvh;
   /* Full screen */
  }

  .carousel-item img {
   height: 70dvh;
   width: auto;
   max-width: 100%;
   object-fit: contain;
   /* Keeps aspect ratio */
   margin: auto;
   display: block;
  }
 </style>
 <style>
  /* Carousel controls */
  #imagesModal .carousel-control-prev-icon,
  #imagesModal .carousel-control-next-icon {
   background-color: black;
   /* black background */
   border-radius: 50%;
   /* make it circular */
   border: 4px solid white;
   opacity: 1;
   width: 40px;
   height: 40px;
  }

  /* Optional: add some opacity hover effect */
  #imagesModal .carousel-control-prev-icon:hover,
  #imagesModal .carousel-control-next-icon:hover {
   opacity: 1;
  }

  /* Carousel indicators */
  #imagesModal .carousel-indicators [data-bs-target] {
   background-color: black;
   /* black indicator */
  }

  /* Active indicator */
  #imagesModal .carousel-indicators .active {
   background-color: black;
   /* active indicator also black */
  }

  #videoPlayer {
   min-width: 300px;
   width: 100%;
   padding: 10px;
   max-width: 450px;
   border-radius: 20px;
   object-fit: cover;
  }

  /* iOS-specific styles for #videoPlayer */
  .ios {
   max-width: 330px !important;
   min-width: 200px !important;
  }

@media (min-width: 480px) {
   .chenda-img {
    max-width: 25dvw!important;
    max-height: 600px!important;
   }
   .flower-img {
    bottom: -30px!important;
   }
  }
 </style>
</head>
<body>
 <!-- Loader -->
 <div class="d-flex flex-column justify-content-center align-items-center position-fixed top-0 start-0 w-100 h-100 bg-body z-3" id="loader">
  <img alt="Logo" class="mb-4" src="https://pkns-youngstar.github.io/get-file/pkns-logo.jpg" style="max-width:150px" />
  <div class="progress w-50" style="height: 12px;">
   <div class="progress-bar progress-bar-striped progress-bar-animated bg-primary" id="progressBar" role="progressbar" style="width: 0%;"></div>
  </div>
  <img alt="Logo" class="mt-4" src="https://pkns-youngstar.github.io/get-file/aaravam-logo.png" style="max-width:200px" />
  <!-- Placeholder for text/button -->
  <div id="loaderContent" class="mt-5 fw-bold text-center">
   Loading...
  </div>
  <div class="position-absolute bottom-0 start-0 m-0">
   <img alt="Chenda" class="chenda-img" src="https://pkns-youngstar.github.io/get-file/chenda.gif" style="position: absolute; bottom: -20px;left:-20px; max-width: 180px;">
  </div>
  <img alt="Flowers" class="flower-img" src="https://pkns-youngstar.github.io/get-file/flower.png" style="position: absolute; bottom: 0px;left:-20px;width:100%;" />
 </div>
 <!-- Bg Video Section -->
 <video loop playsinline webkit-playsinline class="p-0 w-100 h-100 object-fit-cover" style="filter: grayscale(90%);" id="bgVideo">
  <source src="https://pkns-youngstar.github.io/onam-slideshow/videos/a.mp4" type="video/mp4">
 </video>
 <div class="content text-center text-white p-3">
  <div style="position: relative; display: inline-block;">
   <!-- Aaravam Logo (base) -->
   <img alt="Aaravam Logo" class="img-fluid mb-4" src="https://pkns-youngstar.github.io/get-file/aaravam-logo.png">
   <!-- Maveli GIF (overlay at top) -->
   <img alt="Maveli" src="https://pkns-youngstar.github.io/get-file/Maveli_resize.gif" style="position: absolute; top: -150px; left: 58%; transform: translateX(-50%); max-width: 150px;">
  </div>
  <!-- Buttons -->
  <button class="btn btn-light mb-4 w-50 btn-lg" data-bs-toggle="modal" data-bs-target="#promoVideoModal">
   <i class="bi bi-film"></i> Promo Video </button>
  <div class="d-flex justify-content-center gap-3">
   <!-- Images Modal Button -->
   <button class="btn btn-light w-25 btn-lg" data-bs-toggle="modal" data-bs-target="#imagesModal">
    <i class="bi bi-images"></i> Images </button>
   <!-- Video Modal Button -->
   <button class="btn btn-light w-25 btn-lg" data-bs-toggle="modal" data-bs-target="#videosModal">
    <i class="bi bi-film"></i> Videos </button>
  </div>
 </div>
 <!-- Download Button -->
 <a href="#">
  <button class="floating-btn home btn btn-light rounded-circle shadow">
   <i class="bi bi-cloud-download"></i>
  </button>
 </a>
 <!-- Home Button -->
 <a href="https://pkns-youngstarclub.blogspot.com/p/demo.html">
  <button class="floating-btn file btn btn-light rounded-circle shadow">
   <i class="bi bi-file"></i>
  </button>
 </a>
 <!-- Promo Video Modal -->
 <div class="modal fade" id="promoVideoModal" tabindex="-1" aria-labelledby="promoVideoModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-fullscreen">
   <div class="modal-content bg-light">
    <div class="modal-header border-1 py-2 m-">
     <img alt="Logo" src="https://pkns-youngstar.github.io/get-file/aaravam-logo.png" style="max-width:130px" />
     <h4 class="modal-title fw-bold" id="promoVideoModalLabel" style="margin-left:10px"> Promo Video</h4>
     <button type="button" class="btn-close btn-close-dark border" data-bs-dismiss="modal" aria-label="Close"></button>
    </div>
    <div class="modal-body p-0 position-relative d-flex justify-content-center align-items-center">
     <!-- Promo Video -->
     <video id="promoVideo" class="p-3" style="min-width:350px;width:100%;max-width:500px;border-radius:20px;" controls playsinline webkit-playsinline preload="metadata">
      <source src="https://pkns-youngstar.github.io/onam-slideshow/promo/aaravam-pv.mp4" type="video/mp4"> Your browser does not support the video tag.
     </video>
     <!-- Overlay Play Button -->
     <button id="promoPlayBtn" class="btn btn-light rounded-circle mb-4 position-absolute" style="font-size:2rem; width:80px; height:80px;">
      <i class="bi bi-play-fill"></i>
     </button>
    </div>
   </div>
  </div>
 </div>
 <!-- Images Fullscreen Modal -->
 <div class="modal fade" id="imagesModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-fullscreen">
   <div class="modal-content bg-white text-dark">
    <div class="modal-header border-1 py-2 m-">
     <img alt="Logo" src="https://pkns-youngstar.github.io/get-file/aaravam-logo.png" style="max-width:130px" />
     <h4 class="modal-title fw-bold" style="margin-left:10px"> Gallery</h4>
     <button type="button" class="btn-close btn-close-dark border" data-bs-dismiss="modal" aria-label="Close"></button>
    </div>
    <div class="modal-body d-flex justify-content-center align-items-center">
     <img alt="Flowers" src="https://pkns-youngstar.github.io/get-file/Ela-1.png" style="position: absolute; top: 0px;left:-20px;width:100%;" />
     <img alt="Thumbi" src="https://pkns-youngstar.github.io/get-file/thumbi2.gif" style="position: absolute; bottom: 25px;left:0px;width:70px" />
     <img alt="Flowers" src="https://pkns-youngstar.github.io/get-file/flower.png" style="position: absolute; bottom: 0px;left:-20px;width:100%;" />
     <!-- Slideshow Carousel-->
     <div id="githubCarousel" class="carousel slide" data-bs-ride="false">
      <!-- Indicators -->
      <div class="carousel-indicators" id="carouselIndicators"></div>
      <div class="carousel-inner" id="carouselInner"></div>
      <!-- Controls -->
      <button class="carousel-control-prev" type="button" data-bs-target="#githubCarousel" data-bs-slide="prev">
       <span class="carousel-control-prev-icon"></span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#githubCarousel" data-bs-slide="next">
       <span class="carousel-control-next-icon"></span>
      </button>
     </div>
    </div>
   </div>
  </div>
 </div>
 <!-- Videos Fullscreen Modal -->
 <div class="modal fade" id="videosModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-fullscreen">
   <div class="modal-content bg-white text-dark">
    <div class="modal-header border-1 py-2 m-">
     <img alt="Logo" src="https://pkns-youngstar.github.io/get-file/aaravam-logo.png" style="max-width:130px" />
     <h4 class="modal-title fw-bold" style="margin-left:10px"> Video Gallery</h4>
     <button type="button" class="btn-close btn-close-dark border" data-bs-dismiss="modal" aria-label="Close"></button>
    </div>
    <!-- Grid View -->
    <div class="modal-body p-0" id="videoGrid">
     <img alt="Flowers" src="https://pkns-youngstar.github.io/get-file/Ela-1.png" style="position: sticky; top: 0px;left:-20px;width:100%;" />
     <div class="container">
      <div class="row g-3" id="videoThumbnails"></div>
     </div>
     <img alt="Thumbi" src="https://pkns-youngstar.github.io/get-file/thumbi2.gif" style="position: sticky; bottom: 25px;right:60px;width:70px;" />
     <img alt="Flowers" src="https://pkns-youngstar.github.io/get-file/flower.png" style="position: sticky; bottom: 0px;left:-20px;width:100%;" />
    </div>
    <!-- Player View -->
    <div class="modal-body d-none justify-content-center align-items-center" id="videoPlayerWrapper">
     <div class="d-flex flex-column align-items-center w-100">
      <video id="videoPlayer" playsinline webkit-playsinline controls></video>
      <button class="btn btn-sm btn-dark px-4 mt-2" onclick="closeVideo()" style="font-size:0.9rem;">
       <i class="bi bi-caret-left-fill"></i> Back</button>
     </div>
    </div>
   </div>
  </div>
 </div>

 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
 <script>
  // Detect iOS and add class to #videoPlayer
  const videoPlayer = document.getElementById("videoPlayer");

  if (/iPhone|iPad|iPod/i.test(navigator.userAgent)) {
   videoPlayer.classList.add("ios");
  }
 </script>

 <script>
  const videoUsername = "pkns-youngstar";
  const videoRepo = "onam-slideshow";
  const videoBranch = "main";

  // Load all videos from GitHub /videos folder
  async function loadVideos() {
   const res = await fetch(`https://api.github.com/repos/${videoUsername}/${videoRepo}/contents/videos`);
   const files = await res.json();

   const videoFiles = files.filter(f => f.type === "file" && /\.(mp4|webm|ogg)$/i.test(f.name));
   const videoThumbnails = document.getElementById("videoThumbnails");
   videoThumbnails.innerHTML = "";

   videoFiles.forEach(file => {
    const rawUrl = `https://raw.githubusercontent.com/${videoUsername}/${videoRepo}/${videoBranch}/videos/${file.name}`;

    const col = document.createElement("div");
    col.className = "col-md-2 col-4 position-relative";

    // Wrapper with spinner first
    col.innerHTML = `
    <div class="ratio bg-secondary rounded overflow-hidden position-relative" style="--bs-aspect-ratio: 177.77%;">
    <!-- Spinner Overlay -->
    <div class="d-flex justify-content-center align-items-center w-100 h-100 position-absolute top-0 start-0 bg-dark bg-opacity-50" id="spinner-${file.name}">
    <div class="spinner-border text-light"></div>
    </div>

    <!-- Video Thumbnail -->
    <video class="w-100 h-100 object-fit-cover d-none"
    preload="metadata" muted playsinline webkit-playsinline>
    <source src="${rawUrl}#t=0.5" type="video/mp4">
    </video>
    </div>
    <button class="btn btn-sm btn-dark rounded-1 mt-3 px-4 z-2" style="font-size:0.9rem;z-index:2" onclick="openVideo('${rawUrl}')">
    <i class="bi bi-play-fill"></i> Play
    </button>
    <p class="text-center small d-none mt-1">${file.name}</p>
    `;

    videoThumbnails.appendChild(col);

    // Handle spinner removal when thumbnail is ready
    const videoEl = col.querySelector("video");
    const spinner = col.querySelector(`#spinner-${file.name}`);

    videoEl.addEventListener("loadeddata", () => {
     if (spinner) spinner.remove();
     videoEl.classList.remove("d-none");
    });
   });
  }

  // Open video player
  function openVideo(src) {
   document.getElementById('videoGrid').classList.add('d-none');
   document.getElementById('videoPlayerWrapper').classList.remove('d-none');

   const player = document.getElementById('videoPlayer');
   player.src = src;
   player.play();
  }

  // Close video player
  function closeVideo() {
   const player = document.getElementById('videoPlayer');
   player.pause();
   player.src = "";

   document.getElementById('videoPlayerWrapper').classList.add('d-none');
   document.getElementById('videoGrid').classList.remove('d-none');
  }

  // Load videos only when modal is opened
  const videosModal = document.getElementById('videosModal');
  let videosLoaded = false;
  videosModal.addEventListener('shown.bs.modal', () => {
   if (!videosLoaded) {
    loadVideos();
    videosLoaded = true;
   }
  });

  // Stop video when modal closes
  videosModal.addEventListener('hidden.bs.modal', () => {
   closeVideo();
  });
 </script>

 <script>
  window.addEventListener('DOMContentLoaded', () => {
   const loader = document.getElementById('loader');
   const bar = document.getElementById('progressBar');
   const loaderContent = document.getElementById('loaderContent');
   const bgVideo = document.getElementById('bgVideo');

   // Animate the progress bar
   bar.style.width = '2%';
   setTimeout(() => bar.style.width = '25%', 950);
   setTimeout(() => bar.style.width = '45%', 1950);
   setTimeout(() => bar.style.width = '68%', 3500);
   setTimeout(() => bar.style.width = '74%', 4550);
   setTimeout(() => bar.style.width = '89%', 6550);
   setTimeout(() => bar.style.width = '100%', 7000);

   // After 6000ms, replace "Loading..." with a button
   setTimeout(() => {
    loaderContent.innerHTML = `
    <button id="hideLoaderBtn" class="btn btn-sm btn-primary px-4 position-relative" style="z-index:2;">
    Continue
    <span class="position-absolute top-0 start-100 translate-middle pb-5">
    <img alt="Logo" src="https://pkns-youngstar.github.io/get-file/thumbi1.gif" style="max-width:70px" />
    </span>
    </button>`;

    const hideBtn = document.getElementById('hideLoaderBtn');
    hideBtn.addEventListener('click', () => {
     loader.classList.add('hidden');
     setTimeout(() => loader.remove(), 500);

     // Restore last volume state from localStorage
     const savedMuteState = localStorage.getItem("bgVideoMuted");
     if (savedMuteState !== null) {
      bgVideo.muted = savedMuteState === "true";
     } else {
      bgVideo.muted = false; // default: unmuted first time
     }

     bgVideo.play().catch(err => console.warn("Autoplay blocked:", err));

     // Add mute/unmute floating button
     const muteBtn = document.createElement("button");
     muteBtn.id = "muteBtn";
     muteBtn.className = "btn btn-light rounded-circle shadow";
     muteBtn.style.position = "fixed";
     muteBtn.style.bottom = "20px";
     muteBtn.style.right = "20px";
     muteBtn.style.zIndex = "10";
     muteBtn.style.width = "45px";
     muteBtn.style.height = "45px";
     muteBtn.style.display = "flex";
     muteBtn.style.fontSize = "1.3rem";
     muteBtn.style.alignItems = "center";
     muteBtn.style.justifyContent = "center";
     muteBtn.style.opacity = "0.9";
     muteBtn.innerHTML = bgVideo.muted
     ? `<i class="bi bi-volume-mute"></i>`: `<i class="bi bi-volume-up"></i>`;

     document.body.appendChild(muteBtn);

     muteBtn.addEventListener("click", () => {
      bgVideo.muted = !bgVideo.muted;
      muteBtn.innerHTML = bgVideo.muted
      ? `<i class="bi bi-volume-mute"></i>`: `<i class="bi bi-volume-up"></i>`;

      // Save user’s choice
      localStorage.setItem("bgVideoMuted", bgVideo.muted);
     });
    });
   }, 800);
  });
 </script>

 <script>
  const username = "pkns-youngstar";
  const repo = "onam-slideshow";
  const branch = "main";

  let carousel; // bootstrap carousel instance
  let imagesLoaded = false;

  async function loadImages() {
   if (imagesLoaded) return;

   // Fetch contents of "images" folder
   const res = await fetch(`https://api.github.com/repos/${username}/${repo}/contents/images`);
   const files = await res.json();

   // Filter only image files
   let imageFiles = files.filter(f => f.type === "file" && /\.(png|jpe?g|gif|webp)$/i.test(f.name));

   // Sort alphabetically A → Z
   imageFiles.sort((a, b) => a.name.localeCompare(b.name));

   const carouselInner = document.getElementById("carouselInner");
   const carouselIndicators = document.getElementById("carouselIndicators");
   carouselInner.innerHTML = "";
   carouselIndicators.innerHTML = "";

   imageFiles.forEach((file, index) => {
    const rawUrl = `https://raw.githubusercontent.com/${username}/${repo}/${branch}/images/${file.name}`;

    // Carousel Item with custom interval
    const item = document.createElement("div");
    item.className = "carousel-item" + (index === 0 ? " active": "");
    // First slide: 2000ms, others: 3000ms
    item.setAttribute("data-bs-interval", index === 0 ? "2000": "3000");
    item.innerHTML = `<img src="${rawUrl}" alt="${file.name}" class="d-block w-100">`;
    carouselInner.appendChild(item);

    // Carousel Indicator
    const indicator = document.createElement("button");
    indicator.type = "button";
    indicator.setAttribute("data-bs-target", "#githubCarousel");
    indicator.setAttribute("data-bs-slide-to", index);
    if (index === 0) indicator.classList.add("active");
    indicator.setAttribute("aria-current", index === 0 ? "true": "false");
    indicator.setAttribute("aria-label", `Slide ${index + 1}`);
    carouselIndicators.appendChild(indicator);
   });

   // Initialize carousel without auto-start
   const carouselElement = document.getElementById("githubCarousel");
   carousel = new bootstrap.Carousel(carouselElement,
    {
     interval: 3000,
     // default interval for fallback
     ride: false,
     pause: false
    });

   imagesLoaded = true;
  }

  // Load images immediately on page load
  loadImages();

  const imagesModal = document.getElementById('imagesModal');

  // Start slideshow when modal opens
  imagesModal.addEventListener('shown.bs.modal', () => {
   if (carousel) {
    carousel.cycle();
   }
  });

  // Pause slideshow when modal closes
  imagesModal.addEventListener('hidden.bs.modal', () => {
   if (carousel) {
    carousel.pause();
   }
  });
 </script>

 <script>
  const promoModal = document.getElementById('promoVideoModal');
  const promoVideo = document.getElementById('promoVideo');
  const promoPlayBtn = document.getElementById('promoPlayBtn');

  // Play video when play button is clicked
  promoPlayBtn.addEventListener('click', () => {
   promoVideo.play();
   promoPlayBtn.style.display = 'none'; // hide play button while playing
  });

  // Pause and reset video when modal closes
  promoModal.addEventListener('hidden.bs.modal', () => {
   promoVideo.pause();
   promoVideo.currentTime = 0; // reset to start
   promoPlayBtn.style.display = 'block'; // show play button again
  });

  // Optional: hide play button while video is playing if user clicks video directly
  promoVideo.addEventListener('play', () => {
   promoPlayBtn.style.display = 'none';
  });

  promoVideo.addEventListener('pause', () => {
   promoPlayBtn.style.display = 'block';
  });
 </script>

 <script>
  const bgVideo = document.getElementById('bgVideo');
  let openModals = 0; // track how many modals are open

  // When any modal is opened
  document.addEventListener('shown.bs.modal', () => {
   openModals++;
   if (bgVideo && !bgVideo.paused) {
    bgVideo.pause();
   }
  });

  // When any modal is closed
  document.addEventListener('hidden.bs.modal', () => {
   openModals--;
   if (bgVideo && openModals === 0) {
    bgVideo.play();
   }
  });
 </script>

 <script>
  const bgVideo = document.getElementById('bgVideo');
  const hideLoaderBtn = document.getElementById('hideLoaderBtn');

  hideLoaderBtn.addEventListener('click', () => {
   bgVideo.play();
  });
 </script>
</body>
</html>
